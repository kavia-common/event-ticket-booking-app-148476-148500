{"is_source_file": true, "format": "Python", "description": "This file provides authentication utilities for a FastAPI application, including password hashing, JWT token creation and verification, and user authentication dependency.", "external_files": ["src.app.db", "src.app.models"], "external_methods": ["get_session", "User"], "published": ["hash_password", "verify_password", "create_jwt", "decode_jwt", "get_current_user"], "classes": [], "methods": [{"name": "str _b64url_encode(data: bytes)", "description": "Encodes bytes into a URL-safe base64 string without padding.", "scope": "", "scopeKind": ""}, {"name": "bytes _b64url_decode(data: str)", "description": "Decodes a URL-safe base64 string back into bytes, adding necessary padding.", "scope": "", "scopeKind": ""}, {"name": "str hash_password(password: str)", "description": "Hashes a password using SHA256 (for demo purposes, should be replaced with bcrypt in production).", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(password: str, password_hash: str)", "description": "Verifies a password against a SHA256 hash.", "scope": "", "scopeKind": ""}, {"name": "str _sign(data: bytes, secret: str)", "description": "Creates an HMAC SHA256 signature for the given data using the secret.", "scope": "", "scopeKind": ""}, {"name": "str create_jwt(payload: dict, secret: str = JWT_SECRET, exp_seconds: int = JWT_EXP_SECONDS)", "description": "Creates a minimal HS256 JWT token with an expiration.", "scope": "", "scopeKind": ""}, {"name": "Optional[dict] decode_jwt(token: str, secret: str = JWT_SECRET)", "description": "Decodes and verifies a minimal HS256 JWT token.", "scope": "", "scopeKind": ""}, {"name": "User get_current_user(token: str = Depends(oauth2_scheme), session=Depends(get_session))", "description": "FastAPI dependency that retrieves the current user based on JWT token.", "scope": "", "scopeKind": ""}], "calls": ["base64.urlsafe_b64encode", "base64.urlsafe_b64decode", "hashlib.sha256", "hmac.new", "json.dumps", "json.loads", "time.time", "hmac.compare_digest"], "search-terms": ["JWT_SECRET", "create_jwt", "decode_jwt", "auth", "FastAPI dependency", "OAuth2PasswordBearer"], "state": 2, "file_id": 8, "knowledge_revision": 24, "git_revision": "5ee9b2429c198699452802e5b6eab4c297dd9fd1", "ctags": [{"_type": "tag", "name": "JWT_ALG", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^JWT_ALG = \"HS256\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JWT_EXP_SECONDS", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^JWT_EXP_SECONDS = 60 * 60 * 24  # 24h$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "JWT_SECRET", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^JWT_SECRET = \"demo_secret_change_me\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_b64url_decode", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def _b64url_decode(data: str) -> bytes:$/", "language": "Python", "typeref": "typename:bytes", "kind": "function", "signature": "(data: str)"}, {"_type": "tag", "name": "_b64url_encode", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def _b64url_encode(data: bytes) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes)"}, {"_type": "tag", "name": "_sign", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def _sign(data: bytes, secret: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: bytes, secret: str)"}, {"_type": "tag", "name": "create_jwt", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def create_jwt(payload: dict, secret: str = JWT_SECRET, exp_seconds: int = JWT_EXP_SECONDS) -> s/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(payload: dict, secret: str = JWT_SECRET, exp_seconds: int = JWT_EXP_SECONDS)"}, {"_type": "tag", "name": "decode_jwt", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def decode_jwt(token: str, secret: str = JWT_SECRET) -> Optional[dict]:$/", "language": "Python", "typeref": "typename:Optional[dict]", "kind": "function", "signature": "(token: str, secret: str = JWT_SECRET)"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^async def get_current_user(token: str = Depends(oauth2_scheme), session=Depends(get_session)) ->/", "language": "Python", "typeref": "typename:User", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme), session=Depends(get_session))"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/event-ticket-booking-app-148476-148500/backend_api/src/app/services/auth.py", "pattern": "/^def verify_password(password: str, password_hash: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(password: str, password_hash: str)"}], "hash": "565b3f8f635404038f435ae96adea62d", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/app/services/auth.py", "fields": [{"name": "JWT_ALG = \"HS256\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JWT_EXP_SECONDS = 60 * 60 * 24  # 24h", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "JWT_SECRET = \"demo_secret_change_me\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"24": "5ee9b2429c198699452802e5b6eab4c297dd9fd1"}]}